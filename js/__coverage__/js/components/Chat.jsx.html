<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for js/components/Chat.jsx</title>
    <meta charset="utf-8">

    <link rel="stylesheet" href="../../prettify.css">

    <link rel="stylesheet" href="../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header low">
    <h1>Code coverage report for <span class="entity">js/components/Chat.jsx</span></h1>
    <h2>
        
        Statements: <span class="metric">41.94% <small>(13 / 31)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 18)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">11.11% <small>(1 / 9)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">41.94% <small>(13 / 31)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../index.html">All files</a> &#187; <a href="index.html">js/components/</a> &#187; Chat.jsx</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
&nbsp;
var React = require("react/addons");        // var React                    = require('react/addons');
var Reflux = require("reflux");             // var Reflux                   = require('reflux');
var _ = require("lodash");                  // var _                        = require('lodash');
&nbsp;
var ChatSocketMixin = require("../mixins/ChatSocketMixin");     // var ChatSocketMixin          = require('../mixins/ChatSocketMixin');
var CurrentConversationStore = require("../stores/CurrentConversationStore"); // Required since not loaded anywhere else        // var CurrentConversationStore = require('../stores/CurrentConversationStore'); // Required since not loaded anywhere else
var CourseRecipientsStore = require("../stores/CourseRecipientsStore");                                                         // var CourseRecipientsStore    = require('../stores/CourseRecipientsStore');
var CourseActions = require("../actions/CourseActions");                                                                        // var CourseActions            = require('../actions/CourseActions');
var ChatActions = require("../actions/ChatActions");                                                                            // var ChatActions              = require('../actions/ChatActions');
var RecipientList = require("./RecipientList.jsx");                                                                             // var RecipientList            = require('./RecipientList.jsx');
var Conversation = require("./Conversation.jsx");                                                                               // var Conversation             = require('./Conversation.jsx');
&nbsp;
var Chat = React.createClass({
  displayName: "Chat",
&nbsp;
  mixins: [Reflux.ListenerMixin, ChatSocketMixin],
&nbsp;
  propTypes: {
    currentUser: React.PropTypes.object.isRequired,
    course: React.PropTypes.object.isRequired
  },
&nbsp;
  getDefaultProps: function getDefaultProps() {                                                                                 // Line 24:   getDefaultProps: function() {
    return {
      currentUser: {},
      course: {}
    };
  },
&nbsp;
  getInitialState: <span class="fstat-no" title="function not covered" >function getInitialState() {</span>                                                                                 // Line 31:   getInitialState: function() {
<span class="cstat-no" title="statement not covered" >    return {</span>
      error: null,
      recipients: [],
      currentRecipient: {},
      conversation: {}
    };
  },
&nbsp;
  _onRecipientsChange: <span class="fstat-no" title="function not covered" >function _onRecipientsChange(err, recipients) {</span>                                                          // Line 40:   _onRecipientsChange: function(err, recipients) {
<span class="cstat-no" title="statement not covered" >    if (err) {                                                                                                                  // Line 41:     if ( err ) {</span>
<span class="cstat-no" title="statement not covered" >      this.setState({ error: err.message });</span>
    } else {
<span class="cstat-no" title="statement not covered" >      this.setState({ error: null, recipients: recipients });</span>
    }
  },
&nbsp;
  _onConversationChange: <span class="fstat-no" title="function not covered" >function _onConversationChange(err, conversation) {</span>                                                    // Line 48:   _onConversationChange: function(err, conversation) {
<span class="cstat-no" title="statement not covered" >    if (err) {                                                                                                                  // Line 49:     if ( err ) {</span>
<span class="cstat-no" title="statement not covered" >      this.setState({ error: err.message });</span>
    } else {
<span class="cstat-no" title="statement not covered" >      console.log("new conversation:", conversation); </span>                                                                          // Line 52:       console.log('new conversation:', conversation);
<span class="cstat-no" title="statement not covered" >      this.setState({ error: null, conversation: conversation || {} });</span>
    }
  },
&nbsp;
  componentWillMount: <span class="fstat-no" title="function not covered" >function componentWillMount() {</span>                                                                           // Line 57:   componentWillMount: function() {
<span class="cstat-no" title="statement not covered" >    this.listenTo(CourseRecipientsStore, this._onRecipientsChange);</span>
    //this.listenTo(CurrentConversationStore, this._onConversationChange);
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!_.isEmpty(this.props.course) &amp;&amp; !_.isEmpty(this.props.currentUser)) {                                                  // Line 61:     if ( !_.isEmpty(this.props.course) &amp;&amp; !_.isEmpty(this.props.currentUser) ) {</span>
<span class="cstat-no" title="statement not covered" >      CourseActions.openChat(this.props.course.id, this._onRecipientsChange);</span>
    }
  },
&nbsp;
  componentWillReceiveProps: <span class="fstat-no" title="function not covered" >function componentWillReceiveProps(nextProps) {</span>                                                    // Line 66:   componentWillReceiveProps: function(nextProps) {
<span class="cstat-no" title="statement not covered" >    if (!_.isEqual(this.props.course, nextProps.course) || !_.isEqual(this.props.currentUser, nextProps.currentUser)) {         // Line 67:     if( !_.isEqual(this.props.course, nextProps.course) || !_.isEqual(this.props.currentUser, nextProps.currentUser) ) {</span>
<span class="cstat-no" title="statement not covered" >      CourseActions.openChat(nextProps.course.id, this._onRecipientsChange);</span>
    }
  },
&nbsp;
  openConversation: <span class="fstat-no" title="function not covered" >function openConversation(recipient) {</span>                                                                      // Line 72:   openConversation: function(recipient) {
<span class="cstat-no" title="statement not covered" >    if (_.isEmpty(this.state.conversation.recipient) || recipient.id !== this.state.conversation.recipient.id) {                // Line 73:     if ( _.isEmpty(this.state.conversation.recipient) || recipient.id !== this.state.conversation.recipient.id ) {</span>
<span class="cstat-no" title="statement not covered" >      this.joinChat(this.props.course.id, this.props.currentUser.id, recipient.id).then((<span class="fstat-no" title="function not covered" >function () {</span>                          // Line 74:       this.joinChat(this.props.course.id, this.props.currentUser.id, recipient.id).then(function() {</span>
<span class="cstat-no" title="statement not covered" >        ChatActions.openConversation(this.props.course.id, recipient.id, this._onConversationChange);</span>
<span class="cstat-no" title="statement not covered" >        this.setState({ currentRecipient: recipient });</span>
      }).bind(this));                                                                                                           // Line 77:       }.bind(this));
    }
  },
&nbsp;
  render: <span class="fstat-no" title="function not covered" >function render() {</span>                                                                                                   // Line 81:   render: function() {
<span class="cstat-no" title="statement not covered" >    return React.createElement(                                                                                                 //       &lt;section className="chat"&gt;</span>
      "section",
      { className: "chat" },
      React.createElement(Conversation, { currentUser: this.props.currentUser,                                          // Line 85:         &lt;Conversation currentUser={this.props.currentUser}
        currentRecipient: this.state.currentRecipient,                                                                  // Line 86:                       currentRecipient={this.state.currentRecipient}
        course: this.props.course,                                                                                      // Line 87:                       course={this.props.course}
        conversation: this.state.conversation,                                                                          // Line 88:                       conversation={this.state.conversation}
        newMessages: this.state.newMessages,                                                                            // Line 89:                       newMessages={this.state.newMessages}
        sendMessage: this.sendMessage }),                                                                               // Line 90:                       sendMessage={this.sendMessage} /&gt;
      React.createElement(RecipientList, { currentUser: this.props.currentUser,                                         //         &lt;RecipientList currentUser={this.props.currentUser}
        course: this.props.course,                                                                                      //                        course={this.props.course}
        recipients: this.state.recipients,                                                                              //                        recipients={this.state.recipients}
        conversation: this.state.conversation,                                                                          //                        conversation={this.state.conversation}
        openConversation: this.openConversation })                                                                      //                        openConversation={this.openConversation} /&gt;
    );
  }
&nbsp;
});
&nbsp;
module.exports = Chat;
// SourceMap was distributed to comments by gulp-jsx-coverage</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Apr 14 2015 13:17:18 GMT-0400 (EDT)</div>
</div>

<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>

<script src="../../sorter.js"></script>
</body>
</html>
